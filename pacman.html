<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
        canvas {
            border: 1px solid #0e0e0e;
        }
    </style>
</head>

<body onload="gameStart()">

    <script>
        /* var level1 = [
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 2, 2, 2, 2, 2, 0, 2, 2, 2, 2, 2, 0],
            [0, 2, 0, 0, 0, 2, 0, 2, 0, 0, 0, 2, 0],
            [0, 2, 0, 2, 2, 2, 2, 2, 2, 2, 0, 2, 0],
            [0, 2, 2, 2, 0, 0, 5, 0, 0, 2, 2, 2, 0],
            [0, 2, 0, 2, 2, 2, 2, 2, 2, 2, 0, 2, 0],
            [0, 2, 0, 0, 2, 2, 0, 2, 2, 0, 0, 2, 0],
            [0, 2, 2, 2, 2, 2, 0, 2, 2, 2, 2, 2, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        ]; */
        var level1 = [
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 2, 2, 2, 2, 2, 2, 0, 2, 2, 2, 2, 2, 2, 0],
            [0, 2, 0, 2, 0, 0, 2, 0, 2, 0, 2, 0, 0, 2, 0],
            [0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0],
            [0, 0, 0, 2, 0, 2, 0, 0, 0, 2, 0, 2, 0, 0, 0],
            [1, 1, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 1, 1],
            [0, 0, 0, 2, 0, 0, 0, 2, 0, 0, 0, 2, 0, 0, 0],
            [0, 2, 2, 2, 0, 2, 2, 5, 2, 2, 0, 2, 2, 2, 0],
            [0, 0, 0, 2, 0, 0, 0, 2, 0, 0, 0, 2, 0, 0, 0],
            [1, 1, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 1, 1],
            [0, 0, 0, 2, 0, 2, 0, 0, 0, 2, 0, 2, 0, 0, 0],
            [0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0],
            [0, 2, 0, 2, 0, 0, 2, 0, 2, 0, 2, 0, 0, 2, 0],
            [0, 2, 2, 2, 2, 2, 2, 0, 2, 2, 2, 2, 2, 2, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        ];
        var gamePiece;
        x1 = 0; a1 = 0.2; p1 = 0; k = 1; p2 = 0; t = -1; p3 = -1; i1 = 7;
        y1 = 0; a2 = 1.8; q1 = 0; f = 0; q2 = -5; sc = 0; q3 = 0; j1 = 7;
        function gameStart() {
            gamePiece = new pac(10, "yellow", 1, 1);
            gameArea.start();
        }
        var gameArea = {
            canvas: document.createElement("canvas"),
            start: function () {
                this.canvas.width = 500;
                this.canvas.height = 500;
                this.context = this.canvas.getContext("2d");
                document.body.appendChild(this.canvas);
                this.interval = setInterval(updateGameArea, 185);



            },
            clear: function () {
                ctx = gameArea.context;
                ctx.fillStyle = "black";
                ctx.fillRect(0, 0, 500, 500);
                grid();
            }
        }


        function grid() {

            f = 0;

            for (i = 0; i < 15; i++)
                for (j = 0; j < 15; j++)
                    if (level1[i][j] == 0) {
                        ctx = gameArea.context;
                        ctx.fillStyle = "white";
                        ctx.fillRect(j * 24 + 24, i * 24 + 24, 24, 24);
                    }
                    else if (level1[i][j] == 2) {
                        f++;
                        ctx = gameArea.context;
                        ctx.fillStyle = "red";
                        ctx.fillRect(j * 24 + 34, i * 24 + 34, 4, 4);
                    }


            if (f == 0)
                alert("You won");

        }

        function ghost() {

            if (Math.abs(p3)) {
                if (level1[i1][j1 + 1] && level1[i1][j1 - 1]) {
                    if (Math.round(Math.random())) { p3 = 0; q3 = 1 }
                    else { p3 = 0; q3 = -1 }

                }
                else if (level1[i1][j1 + 1]) {
                    p3 = 0; q3 = 1;
                }
                else if (level1[i1][j1 - 1]) {
                    p3 = 0; q3 = -1;
                }
                else if (level1[i1 + p3][j1 + q3]) {
                    q3 = 0;
                }
                else {
                    p3 *= -1; q3 = 0;
                }



            }
            else if (Math.abs(q3)) {
                if (level1[i1 + 1][j1] && level1[i1 - 1][j1]) {
                    if (Math.round(Math.random())) { p3 = 1; q3 = 0 }
                    else { p3 = -1; q3 = 0 }


                }
                else if (level1[i1 + 1][j1]) {
                    p3 = 1; q3 = 0;
                }
                else if (level1[i1 - 1][j1]) {
                    p3 = -1; q3 = 0;
                }
                else if (level1[i1 + p3][j1 + q3]) {
                    p3 = 0;
                }
                else {
                    q3 *= -1; p3 = 0;
                }
            }


            level1[i1][j1] = level1[i1 + p3][j1 + q3];
            level1[i1 + p3][j1 + q3] = 5;
            i1 += p3;
            j1 += q3;


            ctx = gameArea.context;
            ctx.fillStyle = "white";
            ctx.beginPath();
            ctx.arc(j1 * 24 + 36, i1 * 24 + 36, 10, 1 * Math.PI, 2 * Math.PI);
            ctx.lineTo(j1 * 24 + 36, i1 * 24 + 36);
            ctx.fill();
            ctx.fillStyle = "white";
            ctx.moveTo(j1 * 24 + 26, i1 * 24 + 36);
            ctx.lineTo(j1 * 24 + 26, i1 * 24 + 46);
            ctx.lineTo(j1 * 24 + 31, i1 * 24 + 41);
            ctx.lineTo(j1 * 24 + 36, i1 * 24 + 46);
            ctx.lineTo(j1 * 24 + 41, i1 * 24 + 41);
            ctx.lineTo(j1 * 24 + 46, i1 * 24 + 46);
            ctx.lineTo(j1 * 24 + 46, i1 * 24 + 36);
            ctx.fill();

        }


        function pac(rad, color, p, q) {
            this.rad = rad;
            this.p = p;
            this.q = q;
            this.update = function () {
                o = t;
                onkeydown = function (e) {
                    var z = e.keyCode;
                    if (z == 37 || z == 38 || z == 39 || z == 40) {
                        t = -1;
                        if (z == 37) { p1 = 0; q1 = -1; p2 = 0; q2 = -6; a1 = 1.2; a2 = 0.8; }
                        else if (z == 38) { p1 = -1; q1 = 0; p2 = 5; q2 = 0; a1 = 1.7; a2 = 1.3; }
                        else if (z == 39) { p1 = 0; q1 = 1; p2 = 0; q2 = -6; a1 = 0.2; a2 = 1.8; }
                        else if (z == 40) { q1 = 0; p1 = 1; p2 = 5; q2 = 0; a1 = 0.7; a2 = 0.3; }
                    }
                }
                if (level1[this.p][this.q] == 5 || level1[this.p + p1][this.q + q1] == 5)
                    alert("ded");
                else {
                    if (level1[this.p + p1][this.q + q1]) {
                        sc++;
                        gamePiece.p += p1;
                        gamePiece.q += q1;
                        level1[this.p][this.q] = 1;

                    }
                    else { p1 = 0; q1 = 0; }
                }
                if (t *= -1) {
                    a1 -= t * 0.18;
                    a2 += t * 0.18;
                }


                ctx = gameArea.context;
                ctx.fillStyle = color;
                ctx.beginPath();
                ctx.arc((this.q * 24) + 36, (this.p * 24) + 36, this.rad, a1 * Math.PI, a2 * Math.PI);
                ctx.lineTo((this.q * 24) + 36, (this.p * 24) + 36);
                ctx.fill();
                ctx.fillStyle = "black";
                ctx.fillRect((this.q * 24) + 36 + p2, (this.p * 24) + 36 + q2, 2, 2);
                ;
            }

        }






        function updateGameArea() {

            gameArea.clear();
            gamePiece.update();
            ghost();

        }
    </script>

</body>

</html>